With deadlines jeopardized by possible strikes by the Directors Guild of America and the Screen Actors Guild, Bay managed to finish the production on time with the help of previsualization and a scriptment by his writers Roberto Orci, Alex Kurtzman, and series newcomer Ehren Kruger. Shooting took place from May to November 2008, with locations in Egypt, Jordan, Pennsylvania, New Jersey, and California, as well as air bases in New Mexico and Arizona. This was the last film in the series to star Megan Fox, and was also the last film in the series to be co-produced by DreamWorks Pictures, leaving Paramount Pictures as the sole distributor of its future films.