There remained the struggle in Catalonia. At no stage in the war had there been a unanimous or even majority support for Archduke Charles (Charles III) in the principality, but the existence of a rebel group inside the province, together with a superior Allied military and naval presence in Barcelona, forced many towns to decide – often reluctantly – for the Archduke's cause.[160] Nevertheless, those who wished to continue fighting could point to the fact that the Kingdoms of Aragon and Valencia, as well as those in Castile, were subject to a regime that had forced them to change their laws and historic constitutions, and at no stage since his victory at Almansa and the subsequent abolition of the fueros in Aragon and Valencia in 1707, had Philip V shown any intention of respecting Catalonia's privileges. In consequence, Barcelona decided to resist, but there would be no Allied help. After the peace agreements between the major powers neither Austria nor Great Britain could return to a war footing.[161] To compound the issue, Tory diplomatic efforts with Philip V to secure Catalan liberties were half-hearted, and Bolingbroke made no protest when, in early July 1714 – after a year of guerilla warfare in the region – Berwick returned to Catalonia to formally besiege Barcelona. Antoni de Villarroel put up a stout defence of the city, but with little hope of relief the Catalan capital surrendered on 11 September. Cardona soon followed. Majorca held out for nine months until its surrender in July 1715.[162]