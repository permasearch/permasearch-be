Agha Mohammad Khan subsequently demanded Heraclius II to renounce the treaty with Russia of several years earlier, and to reaccept Persian suzerainty,[123] in return for peace and the security of his kingdom. The Ottomans, Iran's neighboring rival, recognized the latters rights over Kartli and Kakheti for the first time in four centuries.[124] Heraclius appealed then to his theoretical protector, Empress Catherine II of Russia, pledging for at least 3,000 Russian troops,[124] but he was ignored, leaving Georgia to fend off the Persian threat alone.[125] Nevertheless, Heraclius II still rejected the Khan's ultimatum.[126] As a response, Agha Mohammad Khan invaded the Caucasus region after crossing the Aras river, and, while on his way to Georgia, he re-subjugated Iran's territories of the Erivan Khanate, Shirvan, Nakhchivan Khanate, Ganja khanate, Derbent Khanate, Baku khanate, Talysh Khanate, Shaki Khanate, Karabakh Khanate, which comprise modern-day Armenia, Azerbaijan, Dagestan, and Igdir. Having reached Georgia with his large army, it culminated in the Battle of Krtsanisi, which resulted in the capture, and sack of Tbilisi, as well as the effective resubjugation of Georgia into Iran.[127][128] Upon his return from his successful campaign in Tbilisi and in effective control over Georgia, together with some 15,000 Georgian captives that were moved back to mainland Iran,[125] Agha Mohammad was formally crowned Shah in 1796 in the Mughan plain, just like his predecessor Nader Shah was about sixty years earlier.