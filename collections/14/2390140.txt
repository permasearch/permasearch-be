Allen spent over 37 years undergoing psychoanalysis. Some of his films, such as Annie Hall, jokingly include references to psychoanalysis. Moment Magazine says, "It drove his self-absorbed work." Allen's biographer, John Baxter, wrote, "Allen obviously found analysis stimulating, even exciting."[178] Allen says his psychoanalysis ended around the time he began his relationship with Previn, although he is still claustrophobic and agoraphobic.[179]