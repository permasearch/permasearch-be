In Sicily, Hamilcar led a night attack on Syracuse, which failed, leading to his capture and subsequent execution by the Syracusans. Agathocles returned to Syracuse in 308 BC and defeated the Punic army, thus lifting the blockade, then returned to Africa. In 307, the war came to an end when Carthage finally managed to defeat the Greeks in Africa, after surviving a coup attempt by Bomilcar. Agathocles abandoned his army and returned to Syracuse, where a treaty divided Sicily between Punic and Greek domains.