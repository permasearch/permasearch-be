Murray made steady progress against the Turkish forces, which were defeated in the battles of Romani, Magdhaba and Rafa. However, he was repulsed at the first and second battle of Gaza in 1917.[217] The defeat in the Second Battle of Gaza prompted the War Office to change the command of the EEF, and on 28 June 1917, Murray was replaced by General Sir Edmund Allenby, who reinvigorated the campaign.[218]