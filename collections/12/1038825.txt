It is clear that in order for this algorithm to work, one needs to have      a  n , n   ( n − 1 )   ≠ 0   {\textstyle a_{n,n}^{(n-1)}\neq 0}   at each step (see the definition of      l  i , n     {\textstyle l_{i,n}}  ). If this assumption fails at some point, one needs to interchange n-th row with another row below it before continuing. This is why the LU decomposition in general looks like      P  − 1   A = L U   {\textstyle P^{-1}A=LU}  .