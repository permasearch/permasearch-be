The Second Arab-Khazar War began with a series of raids across the Caucasus in the early 8th century. The Umayyads tightened their grip on Armenia in 705 after suppressing a large-scale rebellion. In 713 or 714, Umayyad general Maslamah conquered Derbent and drove deeper into Khazar territory. The Khazars launched raids in response into Albania and Iranian Azerbaijan but were driven back by the Arabs under Hasan ibn al-Nu'man.[116] The conflict escalated in 722 with an invasion by 30,000 Khazars into Armenia inflicting a crushing defeat. Caliph Yazid II responded, sending 25,000 Arab troops north, swiftly driving the Khazars back across the Caucasus, recovering Derbent, and advancing on Balanjar. The Arabs broke through the Khazar defence and stormed the city; most of its inhabitants were killed or enslaved, but a few managed to flee north.[115] Despite their success, the Arabs had not yet defeated the Khazar army, and they retreated south of the Caucasus.