Meanwhile, the position of the Portuguese in India was consolidated with the arrival of a new Viceroy, Afonso de Albuquerque, who conquered Goa in 1510. Having established Goa as the Portuguese eastern headquarters and naval base, de Albuquerque decided to capture Malacca and in April 1511, left Goa with 18 ships and 1400 men, comprising both Portuguese troops and Indian auxiliaries. Upon their arrival in Malacca, the Portuguese did not attack immediately, but instead began negotiations for the return of their prisoners while the at same time tried to find any insider information regarding the Malacca Fortress. Malacca procrastinated, thinking it could withstand a Portuguese assault, which started three months later on 25 July 1511. After many failed attempts, the breakthrough was made when the Portuguese bribed an insider of the fortress. The main post gate of the fortress was opened up to allow the Portuguese army to rush through the main gate. The Malaccan army was unprepared for the surprise attack and the invasion concluded on 24 August when de Albuquerque's troops, marching six abreast through the streets, swept aside all resistance. By the time they sacked the city and the palace, Sultan Mahmud Shah had already retreated.[50]