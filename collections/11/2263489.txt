Tengri Bögü Khan made the now extinct Manichaeism the state religion of Uyghur Khaganate in 763 and it was also popular in Karluks. It was gradually replaced by the Mahayana Buddhism.[citation needed] It existed in the Buddhist Uyghur Gaochang up to the 12th century.[179]