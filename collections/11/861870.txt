The defeat at Marathon ended for the time being the Persian invasion of Greece. However, Thrace and the Cycladic islands had been resubjugated into the Persian empire, and Macedon reduced to a subordinate kingdom part of the empire; since the late 6th century BC they had been vassals of the Persians, but remained having a broad scope of autonomy.[16] Darius was still fully intent on conquering Greece, to secure the western part of his empire.[90] Moreover, Athens remained unpunished for its role in the Ionian Revolt, and both Athens and Sparta were unpunished for their treatment of the Persian ambassadors.[91]