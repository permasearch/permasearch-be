While the battle is raging, Denethor attempts to immolate himself and Faramir on his funeral pyre, but Gandalf and Pippin succeed in saving Faramir, aided by Beregond, who has deserted his post and killed several of Denethor's servants in order to save Faramir.  When Gandalf advises Denethor to put aside his madness and go out into battle, Denethor reveals that he has used the palantír of Minas Tirith and declares the situation hopeless. Denethor also reveals that he knows of Aragorn and his claim to the kingship but will not accept him.  He then burns himself with the palantír on the pyre.  Gandalf realizes that Denethor—in his desperation—had looked into the seeing-stone several times. Unlike Saruman, Denethor was too noble of purpose and too great of will to submit to the will of Sauron, but the Dark Lord duped the Steward into despairing of the situation.  The resulting madness kept Gandalf from joining the battle and perhaps saving Théoden and keeping Éowyn and Merry from harm.   Faramir, though, is brought to the Houses of Healing where Gandalf awaits the wounded and Pippin and Beregond guard Faramir, the new Steward of Gondor.