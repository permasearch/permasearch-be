In bacteria, protists, fungi, and plants, melatonin is synthesized indirectly with tryptophan as an intermediate product of the shikimate pathway. In these cells, synthesis starts with D-erythrose 4-phosphate and phosphoenolpyruvate, and in photosynthetic cells with carbon dioxide. The rest of the synthesising reactions are similar, but with slight variations in the last two enzymes.[49][50]