In 1339, Shah Mir became the first Muslim ruler of Kashmir, inaugurating the Shah Mir Dynasty. For the next five centuries, Muslim monarchs ruled Kashmir, including the Mughal Empire, who ruled from 1586 until 1751, and the Afghan Durrani Empire, which ruled from 1747 until 1819. That year, the Sikhs, under Ranjit Singh, annexed Kashmir. In 1846, after the Sikh defeat in the First Anglo-Sikh War, and upon the purchase of the region from the British under the Treaty of Amritsar, the Raja of Jammu, Gulab Singh, became the new ruler of Kashmir. The rule of his descendants, under the paramountcy (or tutelage) of the British Crown, lasted until 1947, when the former princely state became a disputed territory, now administered by three countries: India, Pakistan, and the People's Republic of China.