Alhazen offered an explanation of the Moon illusion, an illusion that played an important role in the scientific tradition of medieval Europe.[83] Many authors repeated explanations that attempted to solve the problem of the Moon appearing larger near the horizon than it does when higher up in the sky. Alhazen argued against Ptolemy's refraction theory, and defined the problem in terms of perceived, rather than real, enlargement. He said that judging the distance of an object depends on there being an uninterrupted sequence of intervening bodies between the object and the observer. When the Moon is high in the sky there are no intervening objects, so the Moon appears close. The perceived size of an object of constant angular size varies with its perceived distance. Therefore, the Moon appears closer and smaller high in the sky, and further and larger on the horizon. Through works by Roger Bacon, John Pecham and Witelo based on Alhazen's explanation, the Moon illusion gradually came to be accepted as a psychological phenomenon, with the refraction theory being rejected in the 17th century.[84] Although Alhazen is often credited with the perceived distance explanation, he was not the first author to offer it. Cleomedes (c. 2nd century) gave this account (in addition to refraction), and he credited it to Posidonius (c. 135-50 BC).[85] Ptolemy may also have offered this explanation in his Optics, but the text is obscure.[86] Alhazen's writings were more widely available in the Middle Ages than those of these earlier authors, and that probably explains why Alhazen received the credit.