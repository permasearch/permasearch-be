Until May 1927, communist support remained strong in Changsha before the massacre carried out by the right-wing faction of the KMT troops. The faction owed its allegiance to Chiang Kai-shek during its offensive against the KMT's left-wing faction under Wang Jingwei, who was then allied closely with the Communists. The purge of communists and suspected communists was part of Chiang's plans for consolidating his hold over the KMT, weakening Wang's control, and thereby over the entire China. In a period of twenty days, Chiang's forces killed more than ten thousand people in Changsha and its outskirts.