While there is no clear-cut account of a sack of Ghana in the contemporary sources, the country certainly did convert to Islam, for al-Idrisi, whose account was written in 1154, has the country fully Muslim by that date. Ibn Khaldun, a fourteenth-century North African historian who read and cited both al-Bakri and al-Idrisi, does report an ambiguous account of the country's history as related to him by 'Uthman, a faqih of Ghana who took a pilgrimage to Mecca in 1394, that the power of Ghana waned as that of the "veiled people" grew, through the Almoravid movement.[37] Al-Idrisi's report does not give any reason in particular to cause us to believe that the Empire was any smaller or weaker than it had been in the days of al-Bakri, seventy five years earlier, and in fact he describes its capital as "the greatest of all towns of the Sudan with respect to area, the most populous, and with the most extensive trade."[24] It is clear, however, that Ghana was incorporated into the Mali Empire, according to a detailed account of al-'Umari, written around 1340, but based on testimony given to him by the "truthful and trustworthy shaykh Abu Uthman Sa'id al-Dukkali, a long term resident.  In al-'Umari/al-Dukkali's version, Ghana still retained its functions as a sort of kingdom within the empire, its ruler being the only one allowed to bear the title malik and "who is like a deputy unto him."[38]