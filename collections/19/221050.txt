Rihanna recorded the song, with vocal production by Thaddis "Kuk" Harrell, in a Westlake Recording Studios in Los Angeles. Initially, Stewart admitted he was still reluctant as to whether Rihanna was the right artist to record the song, but following the recording of the "ella, ella" catch phrase, he felt they were onto "something".[3] Following Rihanna's recording, Def Jam CEO-rapper Jay-Z added his rap. However, Jay-Z rewrote his verse without the awareness of Stewart and Nash. Stewart could not understand it, but later realized it made "sense" instead of the first version. Stewart noted that "from a songwriter's standpoint, he just really made it more about the song, with the metaphors about umbrellas and about the weather versus what he had before".[3]