Sonnet 30 starts with Shakespeare mulling over his past failings and sufferings, including his dead friends and that he feels that he hasn't done anything useful. But in the final couplet Shakespeare comments on how thinking about his friend helps him to recover all of the things that he's lost, and it allows him stop mourning over all that has happened in the past.