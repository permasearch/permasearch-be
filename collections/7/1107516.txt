During the English Civil War it was held for the king but then taken by a Parliamentarian trick without a shot being fired (hence it avoided being ravaged and survives far better than most castles) in 1642.