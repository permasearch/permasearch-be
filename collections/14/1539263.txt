Director Sean Penn's The Pledge (2001), though adapted from a very self-reflexive novel by Friedrich Dürrenmatt, plays noir comparatively straight, to devastating effect.[121] Screenwriter David Ayer updated the classic noir bad-cop tale, typified by Shield for Murder (1954) and Rogue Cop (1954), with his scripts for Training Day (2001) and, adapting a story by James Ellroy, Dark Blue (2002); he later wrote and directed the even darker Harsh Times (2006). Michael Mann's Collateral (2004) features a performance by Tom Cruise as an assassin in the lineage of Le Samouraï. The torments of The Machinist (2004), directed by Brad Anderson, evoke both Fight Club and Memento.[122] In 2005, Shane Black directed Kiss Kiss Bang Bang, basing his screenplay in part on a crime novel by Brett Halliday, who published his first stories back in the 1920s. The film plays with an awareness not only of classic noir but also of neo-noir reflexivity itself.[123]