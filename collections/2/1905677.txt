The rebellion had involved a very wide stretch of territory in northern India. Large numbers of rebels had flocked to Delhi, where they proclaimed the restoration of the Mughal Empire under Bahadur Shah II. A British army besieged the city from the first week in June. On 10 September, they launched a storming attempt, and by 21 September they had captured the city. On 24 September, a column of 2,790 British, Sikh and Punjabi troops under Colonel Greathed of the 8th (The King's) Regiment of Foot marched through the Lahore Gate to restore British rule from Delhi to Cawnpore. On 9 October, Greathed received urgent calls for help from a British garrison in the Red Fort at Agra. He diverted his force to Agra, to find the rebels had apparently retreated. While his force rested, they were surprised and attacked by the rebel force, which had been close by. Nevertheless, they rallied, defeated and dispersed the rebel force. This Battle of Agra cleared all organised rebel forces from the area between Delhi and Cawnpore, although guerrilla bands remained.