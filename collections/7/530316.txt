Professors seem to be able to punish students with relative impunity and can hand out detention, even for unsatisfactory grades. Enforcement of rules outside of class mainly falls to the caretaker, with the assistance of the prefects. A student's Head of House usually has the final say in disciplinary matters. However, during Umbridge's tenure at Hogwarts, she quickly obtains the power to have the final say in disciplinary actions, due to an Educational Decree (one of many) passed by Minister for Magic Cornelius Fudge.